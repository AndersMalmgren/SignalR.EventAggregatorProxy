(function(c,a){c.EventAggregator=function(d){if(d){this.proxy=new b(this);}};c.EventAggregator.prototype=function(){function e(h,g){h=h.genericConstructor||h;var f=g?h.constructor:h;if(f.__subscribers===undefined){f.__subscribers=[];}return f.__subscribers;}function d(h,f){if(h.genericArguments==null){return true;}if(h.genericArguments.length!==f.length){return false;}for(var g=0;g<f.length;g++){if(h.genericArguments[g]!==f[g]){return false;}}return true;}return{unsubscribe:function(f){if(f.__subscribedMessages===undefined){return;}a.each(f.__subscribedMessages,function(){var g=-1;var i=(this.genericConstructor||this).__subscribers;for(var h=0;h<i.length;h++){if(i[h].context==f){g=h;break;}}if(g!=-1){i.splice(g,1);}});if(this.proxy){this.proxy.unsubscribe(f.__subscribedMessages);}},subscribe:function(j,h,g,f){if(g.__subscribedMessages===undefined){g.__subscribedMessages=[];}g.__subscribedMessages.push(j);var i=e.call(this,j,false);i.push({handler:h,context:g,genericArguments:j.genericArguments});if(this.proxy){this.proxy.subscribe(j.genericConstructor||j,j.genericArguments,f);}},publish:function(g,f){var h=e.call(this,g,true);a.each(h,function(){if(d(this,f)){this.handler.call(this.context,g);}});}};}();var b=function(d){this.eventAggregator=d;this.hub=a.connection.eventAggregatorProxyHub;this.hub.client.onEvent=this.onEvent.bind(this);this.queueSubscriptions=true;this.queuedSubscriptions=[];a.connection.hub.start().done(this.onStarted.bind(this));};b.prototype={onStarted:function(){this.queueSubscriptions=false;this.sendSubscribeQueue();},onEvent:function(f){var g=c.getEvent(f.type);var d=new g();for(var e in f.event){d[e]=f.event[e];}this.eventAggregator.publish(d,f.genericArguments);},subscribe:function(e,f,d){if(e.proxyEvent!==true){return;}if(this.queueSubscriptions){this.queuedSubscriptions.push({eventType:e,genericArguments:f,constraint:d});}else{this.hub.server.subscribe(e.type,f,d);}},unsubscribe:function(d){var e=a.map(d,function(g){var f=g.genericConstructor||g;if(f.proxyEvent!==true){return null;}return{type:f.type,genericArguments:g.genericArguments};});if(e.length>0){this.queueSubscriptions=true;this.hub.server.unsubscribe(e).done(function(){this.queueSubscriptions=false;this.sendSubscribeQueue();}.bind(this));}},sendSubscribeQueue:function(){while(this.queuedSubscriptions.length>0){var d=this.queuedSubscriptions.shift();this.subscribe(d.eventType,d.genericArguments,d.constraint);}}};c.eventAggregator=new c.EventAggregator(true);})(window.signalR=window.signalR||{},jQuery);