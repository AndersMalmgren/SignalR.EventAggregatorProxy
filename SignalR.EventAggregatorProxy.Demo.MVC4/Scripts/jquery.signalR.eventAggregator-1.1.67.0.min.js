(function(c,a){c.EventAggregator=function(d){this.constraintId=0;if(d){this.proxy=new b(this);}};c.EventAggregator.prototype=function(){function j(o,n){o=o.genericConstructor||o;var m=n?o.constructor:o;if(m.__subscribers===undefined){m.__subscribers=[];}return m.__subscribers;}function h(m,n){if(m==null){return true;}if(m.length!==n.length){return false;}for(var o=0;o<n.length;o++){if(m[o]!==n[o]){return false;}}return true;}function e(n,m){return m==null||(n.constraintId===m);}function g(m,n){return h(m.type.genericArguments,n.type.genericArguments)&&e(m,n.constraintId);}function i(m){return m.genericConstructor||m;}function f(m,n){if(n===undefined){return false;}for(var p in m){var q=m[p];var r=n[p];var o=typeof q==="object";if(q!==r&&!o){return false;}if(o&&!f(q,r)){return false;}}return true;}function k(m){if(m.__getSubscriptions===undefined){var n=[];m.__getSubscriptions=function(){return n;};}return m.__getSubscriptions();}function l(m){var o=j(m.type,false);if(i(m.type).proxyEvent!==true){return false;}if(o.length===0){d.call(this,m);return true;}if(o.length>0&&m.type.genericArguments==null&&m.constraint==null){return false;}var n=true;a.each(o,function(){if((m.type.genericArguments!=null&&h(m.type.genericArguments,this.type.genericArguments))||(m.constraint!=null&&f(m.constraint,this.constraint))){n=false;m.constraintId=this.constraintId;}});if(n&&m.constraint){d.call(this,m);}return n;}function d(m){m.constraintId=m.constraint?this.constraintId++:null;}return{unsubscribe:function(n){if(n.__getSubscriptions===undefined){return;}var o=n.__getSubscriptions();var m=[];a.each(o,function(){var r=-1;var t=i(this.type).__subscribers;for(var q=0;q<t.length;q++){if(t[q].context==n&&g(this,t[q])){r=q;break;}}if(r!=-1){var u=t.splice(r,1)[0];var p=false;for(var s=0;s<t.length;s++){if(g(u,t[s])){p=true;break;}}if(!p){m.push(u);}}});if(this.proxy){this.proxy.unsubscribe(m);}},subscribe:function(t,o,n,m){var s=k(n);var q=j(t,false);var r={type:t,handler:o,context:n,constraint:m};var p=l.call(this,r);s.push(r);q.push(r);if(this.proxy&&p){this.proxy.subscribe(i(t),t.genericArguments,m,r.constraintId);}},publish:function(o,n,m){var p=j.call(this,o,true);a.each(p,function(){if(h(this.type.genericArguments,n)&&e(this,m)){this.handler.call(this.context,o);}});}};}();var b=function(d){this.eventAggregator=d;this.hub=a.connection.eventAggregatorProxyHub;this.hub.client.onEvent=this.onEvent.bind(this);this.queueSubscriptions=true;this.queuedSubscriptions=[];a.connection.hub.start().done(this.sendSubscribeQueue.bind(this));};b.prototype={onEvent:function(f){var g=c.getEvent(f.type);var d=new g();for(var e in f.event){d[e]=f.event[e];}this.eventAggregator.publish(d,f.genericArguments,f.id);},subscribe:function(f,g,d,e){if(f.proxyEvent!==true){return;}this.queuedSubscriptions.push({type:f.type,genericArguments:g,constraint:d,constraintId:e});if(!this.queueSubscriptions){clearTimeout(this.throttleTimer);this.throttleTimer=setTimeout(this.sendSubscribeQueue.bind(this),1);}},unsubscribe:function(d){var e=a.map(d,function(g){var f=g.type.genericConstructor||g.type;if(f.proxyEvent!==true){return null;}return{type:f.type,genericArguments:g.type.genericArguments,id:g.constraintId};});if(e.length>0){this.queueSubscriptions=true;this.hub.server.unsubscribe(e).done(this.sendSubscribeQueue.bind(this));}},sendSubscribeQueue:function(){this.queueSubscriptions=false;if(this.queuedSubscriptions.length===0){return;}var d=this.queuedSubscriptions;this.queuedSubscriptions=[];this.hub.server.subscribe(d);}};c.eventAggregator=new c.EventAggregator(true);})(window.signalR=window.signalR||{},jQuery);